
<%- include("./partials/header") %>
<body>
    <nav>
        <a href="/"> <h1>Home</h1></a>
       
            <a href="/dashborad"><h1>Tilbake</h1></a>

    </nav>

    <form action="" method="post" enctype="multipart/form-data">
        <h1 class="midden1">ny guide</h1>
        <div class="den">
            <div class="midden">
                <h3>tittel</h3>
                <input type="text" placeholder="tittel" name="tittel" required>
            </div>
            <div class="midden">
                <h3>tag</h3>
                <input type="text" placeholder="tag" name="tag" >
            </div>
            <div class="seksjons"> 
                <div id="addNewsection">
                    <h2 class="midden">seksjon</h2>
                    <div class="midden">
                        <h3>overskrift</h3>
                        <input type="text" placeholder="overskrift" name="overskrift" required>
                    </div>
                    <div class="midden">
                        <h3>beskrivelse</h3>
                        <input type="text" placeholder="beskrivelse" name="beskrivelse" required>
                    </div>
                    <h4>bilde</h4>
                    
                    <h1 class="file-name"></h1>
                    <div class="file-upload">
                        <input type="file" name="bilde"class="fileInput" accept="image/png, image/jpeg, image/jpg" >
                        <div class="dropArea drop-area">
                            <p>Drag & drop your image here</p>
                        </div>
                    </div>
                </div>
                <button class="middle">send inn</button>
            </div>
        </div>
    </form>
    <button onclick="lagNySeksjon()" class="LagSeksjon">lag ny seksjon</button>
    <script>
        // function setupDragAndDrop(dropArea, fileInput) {
        //     // Prevent default behaviors for drag events
        //     ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        //         dropArea.addEventListener(eventName, preventDefaults, false); 
        //         document.body.addEventListener(eventName, preventDefaults, false);
        //     });

        //     function preventDefaults(e) {
        //         e.preventDefault();
        //         e.stopPropagation();
        //     }

        //     // Highlight the drop area when dragging files over it
        //     ['dragenter', 'dragover'].forEach(eventName => {
        //         dropArea.addEventListener(eventName, () => dropArea.classList.add('highlight'), false);
        //     });

        //     ['dragleave', 'drop'].forEach(eventName => {
        //         dropArea.addEventListener(eventName, () => dropArea.classList.remove('highlight'), false);
        //     });

        //     // Handle file dropping
        //     dropArea.addEventListener('drop', handleDrop, false);

        //     function handleDrop(e) {
        //         const dt = e.dataTransfer;
        //         const files = dt.files;

        //         handleFiles(files);
        //     }

        //     // Handle files from input and drop
        //     function handleFiles(files) {
        //         const file = files[0]; // Get the first file

        //         if (file) {
        //             const fileName = document.createElement('p');
        //             fileName.innerText = file.name; // Display the file name
        //             dropArea.appendChild(fileName); // Show file name in drop area
        //             fileInput.files = files; // Update the input field
        //         }
        //     }
        // }
       
    function setupDragAndDrop(dropArea, fileInput, fileNameDisplay) {
        // ... (keep existing preventDefaults and highlight logic) ...

        function handleFiles(files) {
            const file = files[0];
            if (file) {
                fileNameDisplay.textContent = file.name; // Use dedicated display element
                fileInput.files = files;
            }
        }

        // Add click handler to trigger file input
        dropArea.addEventListener('click', () => fileInput.click());
    }

    function lagNySeksjon() {
        const sectionTemplate = document.querySelector('#addNewsection').firstElementChild.cloneNode(true);
        const newSection = sectionTemplate.cloneNode(true);
        
        // Clear existing inputs and file name
        newSection.querySelectorAll('input').forEach(input => input.value = '');
        newSection.querySelector('.file-name').textContent = '';
        
        // Setup new drag and drop
        const dropArea = newSection.querySelector('.dropArea');
        const fileInput = newSection.querySelector('.fileInput');
        const fileNameDisplay = newSection.querySelector('.file-name');
        setupDragAndDrop(dropArea, fileInput, fileNameDisplay);

        document.querySelector('.seksjons').parentNode.insertBefore(newSection, document.querySelector('.LagSeksjon'));
    }

    // Initialize first section
    setupDragAndDrop(
        document.querySelector('.dropArea'),
        document.querySelector('.fileInput'),
        document.querySelector('.file-name')
    );


        // Setup the initial section
        setupDragAndDrop(document.querySelector('.dropArea'), document.querySelector('.fileInput'));

        // Function to create a new section
        function lagNySeksjon() {
            const newSection = document.createElement('div');
            newSection.classList.add('seksjons');
            newSection.innerHTML = `
                <h2>seksjon</h2>
                <div class="midden">
                    <h3>overskrift</h3>
                    <input type="text" placeholder="overskrift" name="overskrift" required>
                </div>
                <div class="midden">
                    <h3>beskrivelse</h3>
                    <input type="text" placeholder="beskrivelse" name="beskrivelse" required>
                </div>
                <h4>bilde</h4>
                <div class="file-upload">
                    <input type="file" name="bilde" class="fileInput" accept="image/png, image/jpeg, image/jpg" required>
                    <div class="dropArea drop-area">
                        <p>Drag & drop your image here</p>
                    </div>
                </div>
            `;
            
            // Append the new section
            document.getElementById('addNewsection').appendChild(newSection);

            // Setup drag and drop for the new section
            const dropArea = newSection.querySelector('.dropArea');
            const fileInput = newSection.querySelector('.fileInput');
            setupDragAndDrop(dropArea, fileInput);
        }

        // Function to create a new section
//         function lagNySeksjon() {
//     let newSection = document.querySelector("#addNewsection");
//     newSection.innerHTML += `
//         <div class="seksjons"> 
//             <h2>seksjon</h2>
//             <div class="midden">
//                 <h3>overskrift</h3>
//                 <input type="text" placeholder="overskrift" name="overskrift" required>
//             </div>
//             <div class="midden">
//                 <h3>beskrivelse</h3>
//                 <input type="text" placeholder="beskrivelse" name="beskrivelse" required>
//             </div>
//             <h4>bilde</h4>
//             <div class="file-upload">
//                 <input type="file" name="bilde" id="fileInput" accept="image/png, image/jpeg, image/jpg" required>
//                 <div id="dropArea" class="drop-area">
//                     <p>Drag & drop your image here</p>
//                 </div>
//             </div>
//         </div>
//     `;
// }


    // </script>
   
</body>
</html>